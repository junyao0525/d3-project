<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Olist Insights Dashboard</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <!-- <style>
      /* Tab-specific styles */
      .geographic-tab .info-card {
        background: linear-gradient(
          135deg,
          rgba(56, 189, 248, 0.1),
          rgba(14, 165, 233, 0.1)
        );
        border: 1px solid rgba(14, 165, 233, 0.3);
      }
      .geographic-tab .info-card::before {
        background: linear-gradient(90deg, #38bdf8, #0ea5e9);
      }
      .geographic-tab .info-card .value {
        color: #0ea5e9;
      }

      .payment-tab .info-card {
        background: linear-gradient(
          135deg,
          rgba(139, 92, 246, 0.1),
          rgba(124, 58, 237, 0.1)
        );
        border: 1px solid rgba(139, 92, 246, 0.3);
      }
      .payment-tab .info-card::before {
        background: linear-gradient(90deg, #8b5cf6, #7c3aed);
      }
      .payment-tab .info-card .value {
        color: #7c3aed;
      }

      .product-tab .info-card {
        background: linear-gradient(
          135deg,
          rgba(16, 185, 129, 0.1),
          rgba(5, 150, 105, 0.1)
        );
        border: 1px solid rgba(16, 185, 129, 0.3);
      }
      .product-tab .info-card::before {
        background: linear-gradient(90deg, #10b981, #059669);
      }
      .product-tab .info-card .value {
        color: #059669;
      }

      /* Tab-specific chart container styles */
      .geographic-tab .chart-container::before {
        background: linear-gradient(90deg, #38bdf8, #0ea5e9);
      }
      .payment-tab .chart-container::before {
        background: linear-gradient(90deg, #8b5cf6, #7c3aed);
      }
      .product-tab .chart-container::before {
        background: linear-gradient(90deg, #10b981, #059669);
      }

      /* Unique layout for payment tab */
      .payment-tab .dashboard-grid.insights {
        grid-template-columns: repeat(3, 1fr);
      }
      .payment-tab .dashboard-grid.visuals {
        grid-template-columns: repeat(2, 1fr);
      }
      .payment-tab .chart-container.big {
        grid-column: span 2;
      }

      /* Product tab specific styles */
      .product-tab .dashboard-grid {
        grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
      }
      .product-tab .chart-container.wide {
        grid-column: span 2;
      }
    </style> -->
  </head>

  <body>
    <header>🛒 Olist E-Commerce Analytics Dashboard</header>
    <div class="loading" id="loading">Loading data...</div>
    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab(0)">
        🗺️ Geographic Insights
      </button>
      <button class="tab-btn" onclick="switchTab(1)">
        💳 Payment Analysis
      </button>
      <button class="tab-btn" onclick="switchTab(2)">
        📦 Product Performance
      </button>
    </div>

    <div class="selection-info" id="selection-info" style="display: none">
      <span>🔍 Showing data for: </span>
      <span id="selected-item">State</span>
      <button class="clear-btn" onclick="clearSelection()">
        Clear Selection
      </button>
    </div>

    <div class="dashboard active geographic-tab">
      <div class="dashboard-content">
        <div class="filter-container">
          <label for="geo-filter">🎯 Filter by State:</label>
          <select id="geo-filter">
            <option value="">All States</option>
          </select>
          <button id="reset-selection" class="reset-btn">
            Reset Selection
          </button>
          <div class="active-filter" id="active-filter-display">
            Showing all states
          </div>
        </div>

        <div class="section-title">
          <span>📊 Regional Performance Metrics</span>
        </div>

        <div class="dashboard-grid">
          <div class="info-card">
            <h3>Total Revenue</h3>
            <div class="value" id="total-revenue">Loading</div>
            <div class="label">
              <div class="label">Loading...</div>
            </div>
          </div>

          <div class="info-card">
            <h3>Avg. Delivery Time</h3>
            <div class="value" id="avg-delivery">Loading</div>
            <div class="label">
              Nationwide average |
              <div class="label">Loading...</div>
            </div>
          </div>

          <div class="info-card">
            <h3>Customer Satisfaction</h3>
            <div class="value" id="avg-review">Loading</div>
            <div class="label">
              <div class="label">Loading...</div>
            </div>
          </div>
        </div>
        <div class="section-title">
          <span>🗺️ Geographic Distribution</span>
        </div>

        <div class="map-container">
          <div class="map-title">💰 Total Revenue by Brazilian State</div>
          <div class="map-box">
            <div id="brazil-map">
              <svg class="map-svg" style="background-color: #f9f9f9"></svg>
            </div>
            <div class="map-info-panel">
              <div class="map-title">Regional Performance Summary</div>
              <div class="map-stats">
                <div class="stat-item">
                  <div class="stat-label">Top Performing State</div>
                  <div class="stat-value">Loading...</div>
                  <div class="stat-detail">Loading...</div>
                </div>
                <div class="stat-item">
                  <div class="stat-label">Fastest Delivery</div>
                  <div class="stat-value">Loading...</div>
                  <div class="stat-detail">Loading...</div>
                </div>
                <div class="stat-item">
                  <div class="stat-label">Highest Satisfaction</div>
                  <div class="stat-value">Loading...</div>
                  <div class="stat-detail">Loading...</div>
                </div>
              </div>
            </div>
          </div>
          <div id="selected-state-info"></div>
        </div>
      </div>

      <div class="section-title">
        <span>📈 State-by-State Comparison</span>
      </div>

      <div class="dashboard-grid-2">
        <div class="chart-container">
          <div class="chart-title">Revenue Distribution by State</div>
          <canvas id="revenueByState" height="400"></canvas>
          <div class="chart-note">Loading ...</div>
        </div>

        <div class="chart-container">
          <div class="chart-title">Delivery Efficiency</div>
          <canvas id="deliveryTimeByState" height="400"></canvas>
          <div class="chart-note">Loading ...</div>
        </div>

        <div class="chart-container">
          <div class="chart-title">Customer Satisfaction Scores</div>
          <canvas id="reviewScoreByState" height="400"></canvas>
          <div class="chart-note">Loading ...</div>
        </div>

        <div class="chart-container">
          <div class="chart-title">Freight Cost vs Revenue</div>
          <canvas id="freightVsRevenue" height="400"></canvas>
          <div class="chart-note">Loading ...</div>
        </div>
      </div>
    </div>

    <!-- Product Performance Tab -->
    <div class="dashboard product-tab">
      <div class="dashboard-content">
        <div class="filter-container">
          <label for="category-filter">📦 Filter by Product Category:</label>
          <select id="category-filter">
            <option value="">All Categories</option>
            <option value="electronics">Electronics</option>
            <option value="home">Home & Kitchen</option>
            <option value="books">Books</option>
            <option value="beauty">Beauty</option>
            <option value="clothing">Clothing</option>
          </select>
          <button id="reset-category-filter" class="reset-btn">
            Reset Selection
          </button>
          <div class="active-filter" id="category-filter-display">
            All categories
          </div>
        </div>

        <div class="section-title">💡 Product Performance Insights</div>
        <div class="dashboard-grid">
          <div class="info-card" id="lowest-revenue-card">
            <h3>📉 Lowest Revenue Category</h3>
            <div class="value">loading...</div>
            <div class="label">loading...</div>
            <div class="trend-indicator trend-down">loading...</div>
          </div>

          <div class="info-card" id="lowest-review-card">
            <h3>😞 Lowest Review Score</h3>
            <div class="value">loading...</div>
            <div class="label">loading...</div>
            <div class="trend-indicator trend-down">loading...</div>
          </div>

          <div class="info-card" id="fastest-growth-card">
            <h3>📈 Fastest Growing</h3>
            <div class="value">loading...</div>
            <div class="label">loading...</div>
            <div class="trend-indicator trend-up">loading...</div>
          </div>

          <div class="info-card" id="highest-satisfaction-card">
            <h3>⭐ Highest Satisfaction</h3>
            <div class="value">loading...</div>
            <div class="label">loading...</div>
            <div class="trend-indicator trend-up">loading...</div>
          </div>
        </div>

        <div class="section-title">📊 Category Performance Analysis</div>
        <div class="dashboard-grid">
          <div class="chart-container">
            <div class="chart-title">Revenue Distribution by Category</div>
            <canvas id="revenueByCategory"></canvas>
            <div class="chart-note">Loading ...</div>
          </div>

          <div class="chart-container">
            <div class="chart-title">Customer Satisfaction Scores</div>
            <canvas id="reviewByCategory"></canvas>
            <div class="chart-note">Loading ...</div>
          </div>

          <div class="chart-container wide">
            <div class="chart-title">Revenue vs Customer Satisfaction</div>
            <canvas id="scatterRevenueReview"></canvas>
            <div class="chart-note">Loading ...</div>
          </div>

          <div class="chart-container">
            <div class="chart-title">Return Rates by Category</div>
            <canvas id="returnByCategory"></canvas>
            <div class="chart-note">Loading ...</div>
          </div>
        </div>

        <div class="action-panel">
          <div class="action-title">Recommended Actions</div>
          <ul class="action-list">
            <li>
              📦 Investigate quality issues in Electronics category driving low
              reviews
            </li>
            <li>
              📚 Develop promotion strategy for Books category to boost revenue
            </li>
            <li>
              💄 Capitalize on Beauty category growth with targeted marketing
            </li>
          </ul>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    <script src="app_q1.js"></script>
    <script src="app_q3.js"></script>
    <script>
      function switchTab(index) {
        // Remove active class from all tabs and dashboards
        document
          .querySelectorAll(".tab-btn")
          .forEach((btn) => btn.classList.remove("active"));
        document.querySelectorAll(".dashboard").forEach((dash) => {
          dash.classList.remove("active");
          dash.style.display = "none";
        });

        // Add active class to selected tab and dashboard
        document.querySelectorAll(".tab-btn")[index].classList.add("active");
        document.querySelectorAll(".dashboard")[index].classList.add("active");
        document.querySelectorAll(".dashboard")[index].style.display = "block";
      }
    </script>
  </body>
</html>
